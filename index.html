<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Grow a Garden - Trade Center</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
<style>
  * { box-sizing: border-box; }
  body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(to right, #dceefb, #e0f7fa);
    margin: 0; padding: 0; min-height: 100vh;
    display: flex; flex-direction: column;
  }
  header {
    background: linear-gradient(90deg, #38b2ac, #4fd1c5);
    padding: 15px 20px;
    color: white;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
  }
  header h1 {
    margin: 0;
    font-size: 1.5rem;
    flex-grow: 1;
    min-width: 200px;
  }
  #onlineCount {
    font-weight: 600;
    background: #2c7a7b;
    padding: 6px 12px;
    border-radius: 12px;
    margin-right: 20px;
    white-space: nowrap;
  }
  #userInfo {
    display: flex;
    align-items: center;
    gap: 10px;
    white-space: nowrap;
  }
  #nicknameDisplay {
    font-weight: 600;
  }
  .profile-photo {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid white;
    cursor: pointer;
  }
  button {
    background-color: #38b2ac;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    font-size: 1rem;
  }
  button:hover {
    background-color: #319795;
  }
  main {
    flex-grow: 1;
    display: flex;
    gap: 20px;
    padding: 20px;
    flex-wrap: wrap;
    justify-content: center;
  }
  aside {
    width: 15%;
    min-width: 120px;
    background: #f1f1f1;
    padding: 10px;
    text-align: center;
    border-radius: 10px;
    border: 1px solid #ccc;
    user-select: none;
  }
  section.content {
    flex-grow: 1;
    max-width: 900px;
    min-width: 320px;
  }
  .form-group {
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: #333;
  }
  input, select, textarea, button {
    font-family: inherit;
    font-size: 16px;
  }
  input, select, textarea {
    width: 100%;
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
  }
  .login-section, .trade-section {
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    margin-bottom: 20px;
  }
  .hidden {
    display: none !important;
  }
  #trade-feed, #vouches {
    background: white;
    border: 1px solid #ddd;
    padding: 15px;
    height: 280px;
    overflow-y: auto;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    margin-top: 10px;
  }
  #trade-feed > div, #vouches > div {
    border-bottom: 1px solid #eee;
    padding: 8px 0;
    display: flex;
    align-items: flex-start;
    gap: 10px;
  }
  #trade-feed img, #vouches img {
    width: 30px; height: 30px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
  }
  #trade-feed div:last-child, #vouches div:last-child {
    border-bottom: none;
  }
  .trade-details {
    font-size: 0.9rem;
    color: #555;
  }
  .trade-title {
    font-weight: 600;
  }
  .trade-user {
    font-weight: 700;
  }
  .trade-date {
    font-size: 0.75rem;
    color: #999;
    margin-left: auto;
    white-space: nowrap;
  }
  @media (max-width: 768px) {
    main {
      flex-direction: column;
    }
    aside {
      width: 100%;
      min-width: auto;
      margin-bottom: 20px;
    }
    section.content {
      max-width: 100%;
    }
    header {
      flex-direction: column;
      gap: 10px;
      align-items: flex-start;
    }
    #onlineCount, #userInfo {
      margin-right: 0;
    }
  }
</style>
</head>
<body>

<header>
  <h1>üå± Grow a Garden - Trade Center üå∏</h1>
  <div style="display:flex; align-items:center; gap:15px; flex-wrap: wrap;">
    <div id="onlineCount">Online: 0</div>

    <div id="userInfo" class="hidden">
      <span id="nicknameDisplay"></span>
      <img id="profilePic" class="profile-photo" src="https://via.placeholder.com/40?text=?" alt="Foto profilo" title="Clicca per cambiare foto profilo" />
      <input type="file" id="profilePicInput" accept="image/*" style="display:none" />
    </div>

    <button id="loginBtn">Login</button>
    <button id="logoutBtn" class="hidden">Logout</button>
    <button id="donateBtn" title="Supportaci con una donazione">üíñ Supportaci</button>
  </div>
</header>

<main>
  <aside>
    <p><strong>Ad Banner 1</strong></p>
    <hr />
    <p><strong>Ad Banner 2</strong></p>
  </aside>

  <section class="content">

    <!-- Login Form -->
    <div id="loginSection" class="login-section">
      <h2>Login / Registrati</h2>
      <div class="form-group">
        <label for="nicknameInput">Nickname (obbligatorio)</label>
        <input type="text" id="nicknameInput" placeholder="Inserisci il tuo nickname" autocomplete="off" />
      </div>
      <div class="form-group">
        <label for="emailInput">Email (opzionale)</label>
        <input type="email" id="emailInput" placeholder="Inserisci la tua email" autocomplete="off" />
      </div>
      <button id="doLoginBtn">Accedi</button>
    </div>

    <!-- Trade & Feedback Section (visibile solo dopo login) -->
    <div id="tradeSection" class="trade-section hidden">

      <div class="form-group">
        <label for="title">Titolo dell'offerta</label>
        <input type="text" id="title" placeholder="Es: Scambio pet per shekel" autocomplete="off" />
      </div>

      <div class="form-group">
        <label for="tradeType">Tipo di scambio</label>
        <select id="tradeType" onchange="updateTradeFields()">
          <option value="pet-for-pet">Pet per Pet</option>
          <option value="pet-for-shekels">Pet per Shekels</option>
          <option value="shekels-for-pet">Shekels per Pet</option>
        </select>
      </div>

      <div class="form-group" id="trade-details"></div>

      <button onclick="postTrade()">Pubblica Offerta</button>
      <button onclick="sendFeedback()">Invia Feedback</button>

      <hr />

      <div class="form-group">
        <label for="filterType">Filtra per tipo di scambio:</label>
        <select id="filterType" onchange="updateFeed()">
          <option value="all">Tutti</option>
          <option value="pet-for-pet">Pet per Pet</option>
          <option value="pet-for-shekels">Pet per Shekels</option>
          <option value="shekels-for-pet">Shekels per Pet</option>
        </select>
      </div>

      <div class="form-group">
        <label for="search">Cerca offerte:</label>
        <input type="text" id="search" oninput="updateFeed()" placeholder="Cerca per parola chiave..." autocomplete="off" />
      </div>

      <h2>üìã Offerte in tempo reale</h2>
      <div id="trade-feed"></div>

      <h2>‚≠ê Recensioni e Vouches</h2>
      <div id="vouches"></div>
    </div>

  </section>

  <aside>
    <p><strong>Ad Banner 3</strong></p>
    <hr />
    <p><strong>Ad Banner 4</strong></p>
  </aside>
</main>

<script>
  // Lista pet aggiornata senza "Dragon"
  const petList = [
    "Golden Lab", "Bunny", "Cat", "Chicken", "Deer", "Black Bunny", "Rabbit",
    "Orange Tabby", "Spotted Deer", "Monkey", "Pig", "Mole", "Otter", "Bee",
    "Bear Bee", "Petal Bee", "Queen Bee", "Butterfly", "Tarantula Hawk", "Mini Octopus",
    "Flamingo", "Orangutan", "Polar Bear", "Red Giant Ant", "Dragonfly", "Disco Bee",
    "Wasp", "Capybara", "Mimic Octopus", "Toucan", "Seal", "Sea Turtle", "Crab"
  ];

  let trades = [];
  let vouches = [];

  // Simula utenti online (numero casuale ogni 30s)
  function updateOnlineCount() {
    const count = Math.floor(Math.random() * 39) + 12; // da 12 a 50
    document.getElementById('onlineCount').textContent = `Online: ${count}`;
  }
  updateOnlineCount();
  setInterval(updateOnlineCount, 30000);

  // ELEMENTI UI
  const loginSection = document.getElementById('loginSection');
  const tradeSection = document.getElementById('tradeSection');
  const loginBtn = document.getElementById('loginBtn');
  const logoutBtn = document.getElementById('logoutBtn');
  const userInfo = document.getElementById('userInfo');
  const nicknameDisplay = document.getElementById('nicknameDisplay');
  const profilePic = document.getElementById('profilePic');
  const profilePicInput = document.getElementById('profilePicInput');
  const donateBtn = document.getElementById('donateBtn');

  let currentUser = null;

  // Salva utente in localStorage (simula sessione)
  function saveUser(user) {
    localStorage.setItem('growGardenUser', JSON.stringify(user));
  }
  function loadUser() {
    const user = localStorage.getItem('growGardenUser');
    return user ? JSON.parse(user) : null;
  }
  function clearUser() {
    localStorage.removeItem('growGardenUser');
  }

  // Mostra UI logged-in
  function showLoggedIn(user) {
    currentUser = user;
    loginSection.classList.add('hidden');
    tradeSection.classList.remove('hidden');
    loginBtn.classList.add('hidden');
    logoutBtn.classList.remove('hidden');
    userInfo.classList.remove('hidden');
    nicknameDisplay.textContent = user.nickname;
    profilePic.src = user.photo || 'https://via.placeholder.com/40?text=?';
  }
  //
